<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicio</title>

    <link rel="icon" type="image/png" href="./img/icon.png" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
        integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Datatable CSS -->
    <link rel="stylesheet" href=" https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css" />

    <!-- Script CSS -->
    <link href="./styles.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .libro-item {
            display: flex;
            align-items: center;
            padding: 1.5rem;
            /* Aumenta el padding para mayor espacio */
            border-bottom: 1px solid #e5e7eb;
            transition: background-color 0.3s ease;
            /* Transición suave para el hover */
        }

        .libro-item:last-child {
            border-bottom: none;
        }

        .libro-item:hover {
            background-color: #f7fafc;
            /* Color de fondo al pasar el mouse */
        }

        .libro-imagen {
            width: 100px;
            /* Aumenta el tamaño de la imagen */
            height: 150px;
            /* Aumenta el tamaño de la imagen */
            object-fit: cover;
            border-radius: 0.5rem;
            margin-right: 1.5rem;
            /* Aumenta el margen derecho */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            /* Añade sombra */
            transition: transform 0.2s ease;
            /* Transición suave para el hover */
        }

        .libro-imagen:hover {
            transform: scale(1.05);
            /* Escala la imagen al pasar el mouse */
        }

        .libro-info {
            flex: 1;
        }

        .libro-titulo {
            font-size: 1.5rem;
            /* Aumenta el tamaño del título */
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
            /* Aumenta el margen inferior */
            transition: color 0.3s ease;
            /* Transición suave para el color */
        }

        .libro-titulo:hover {
            color: #6b7280;
            /* Cambia el color del título al pasar el mouse */
        }

        .libro-descripcion {
            font-size: 1rem;
            /* Aumenta el tamaño de la descripción */
            color: #4b5563;
            margin-bottom: 0.75rem;
            /* Aumenta el margen inferior */
            line-height: 1.6;
            /* Mejora la legibilidad del texto */
        }

        .libro-etiquetas {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            /* Aumenta el gap */
            margin-top: 0.5rem;
            /* Añade margen superior */
        }

        .libro-etiqueta {
            padding: 0.375rem 0.75rem;
            /* Aumenta el padding */
            border-radius: 1.5rem;
            /* Aumenta el border-radius */
            font-size: 0.875rem;
            /* Aumenta el tamaño de la fuente */
            font-weight: 500;
            /* Añade peso a la fuente */
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.08), 0 1px 2px -1px rgba(0, 0, 0, 0.06);
            /* Añade sombra */
            transition: transform 0.2s ease;
            /* Transición suave para el hover */
        }

        .libro-etiqueta:hover {
            transform: scale(1.1);
            /* Escala la etiqueta al pasar el mouse */
        }

        .genero {
            background-color: #f0fdf4;
            color: #065f46;
        }

        .disponibilidad {
            background-color: #eff6ff;
            color: #1d4ed8;
        }

        .filtro-titulo {
            font-size: 1rem;
            /* Reajusta el tamaño del título del filtro */
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.75rem;
            /* Reajusta el margen inferior */
            padding-left: 0.5rem;
            border-left: 4px solid #6b7280;
        }

        .filtro-opcion {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            /* Reajusta el margen inferior */
        }

        .filtro-checkbox {
            margin-right: 0.75rem;
            width: 1rem;
            /* Reajusta el tamaño del checkbox */
            height: 1rem;
            /* Reajusta el tamaño del checkbox */
        }

        .filtro-label {
            font-size: 0.9rem;
            /* Reajusta el tamaño de la etiqueta del filtro */
            color: #374151;
            transition: color 0.3s ease;
        }

        .filtro-label:hover {
            color: #6b7280;
        }

        .filtrar-button {
            margin-top: 1rem;
            /* Reajusta el margen superior */
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            /* Reajusta el tamaño de la fuente del botón */
            font-weight: 600;
            border-radius: 0.75rem;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 6px 10px -2px rgba(0, 0, 0, 0.15), 0 3px 7px -2px rgba(0, 0, 0, 0.1);
        }

        .filtrar-button:hover {
            background-color: #2563eb;
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 12px -2px rgba(0, 0, 0, 0.2), 0 4px 8px -2px rgba(0, 0, 0, 0.15);
        }

        .filtrar-button:active {
            transform: translateY(0);
            box-shadow: 0 3px 5px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06);
        }

        @media (max-width: 768px) {
            .libro-item {
                flex-direction: column;
                text-align: center;
            }

            .libro-imagen {
                margin-right: 0;
                margin-bottom: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm mb-4">
            <div class="container-fluid">
                <!-- Logo -->
                <a class="navbar-brand" href="/">
                    <img src="./img/icon.png" alt="Logotipo" width="30" height="30"
                        class="d-inline-block align-text-top">
                    <span class="ms-2">SmartBiblio</span>
                </a>

                <!-- Botón móvil -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Contenido del navbar -->
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" href="./libros"><i class="fas fa-book"></i> Libros</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./socios"><i class="fas fa-users"></i> Socios</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./reservas"><i class="fas fa-calendar-alt"></i> Reservas</a>
                        </li>
                    </ul>

                    <!-- Buscador -->
                    <div class="d-flex align-items-center me-3 search-container">
                        <input type="text" class="form-control search-input me-2" id="busqueda-input"
                            placeholder="Buscar...">
                        <button class="btn btn-outline-light" id="buscar-button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>

                    <!-- Login / Perfil -->
                    <!-- Por ahora sin Spring Security -->
                    <div>
                        <a href="./login" class="btn btn-primary ms-2">
                            <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
                        </a>
                    </div>

                    <!-- Dropdown de perfil (muestra fija por ahora) -->
                    <div class="ms-2">
                        <div class="dropdown">
                            <button class="btn btn-secondary dropdown-toggle" type="button" id="profileDropdown"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user"></i> Mi Perfil
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                                <li><a class="dropdown-item" href="./perfil"><i class="fas fa-user-circle"></i> Ver
                                        Perfil</a></li>
                                <li><a class="dropdown-item" href="./configuracion"><i class="fas fa-cog"></i>
                                        Configuración</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="./logout"><i class="fas fa-sign-out-alt"></i> Cerrar
                                        Sesión</a></li>
                                <!-- Para administradores -->
                                <li><a class="dropdown-item" href="./admin/panel.html"><i class="fas fa-tools"></i>
                                        Panel
                                        Admin</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto py-8">
        <div class="row mb-6 mb-4">
            <div class="col-md-12">
                <div class="input-group shadow-sm rounded">
                    <input type="text" id="busqueda-input" class="form-control form-control-lg border-0"
                        placeholder="Buscar libros por título, autor o género...">
                    <button id="buscar-button" class="btn btn-primary btn-lg rounded-end" type="button">
                        <i class="fas fa-search"></i> Buscar
                    </button>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-3">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="filtro-titulo">Filtrar por Autor</div>
                    <div id="filtro-autores" class="space-y-3">
                    </div>
                    <div class="filtro-titulo mt-4">Filtrar por Género</div>
                    <div id="filtro-generos" class="space-y-3">
                    </div>
                    <button id="filtrar-button" class="btn btn-primary w-full mt-3">Filtrar</button>
                </div>
            </div>

            <div class="col-md-9">
                <div id="lista-libros" class="bg-white rounded-lg shadow-md">
                </div>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer>
        <div class="text-center bg-dark text-light p-3">
            Todos los Derechos Reservado © 2025 Copyright
            <a class="text-warning fw-bold text-decoration-none"
                href="https://www.instagram.com/mango.storeok/">MangoSoft</a>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>

    <!-- DATATABLE JS -->
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
    <!-- CSS de DataTables Responsive -->
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">

    <!-- SWEET ALERT -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.3.0/dist/sweetalert2.all.min.js"></script>

    <!-- JQUERY UI JS -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"
        integrity="sha256-lSjKY0/srUM9BE3dPm+c4fBo1dky2v27Gdjm2uoZaL0=" crossorigin="anonymous"></script>

    <!-- JQUERY MASK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>

    <!-- Scripts JS -->
    <script src="./js/scripts.js"></script>
    <script src="./js/datatables.js"></script>

    <script>
        const searchBtn = document.getElementById('searchButton');
        const searchInput = document.getElementById('searchInput');

        searchBtn.addEventListener('click', () => {
            const isActive = searchInput.classList.toggle('active');

            if (isActive) {
                setTimeout(() => searchInput.focus(), 300);
            } else {
                searchInput.blur();
            }
        });
    </script>

    <script>
        const libros = [
            {
                titulo: "El Nombre del Viento",
                autor: "Patrick Rothfuss",
                genero: "Ficción",
                disponibilidad: "Disponible",
                descripcion: "Primer libro de la saga Crónica del Asesino de Reyes.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Cien años de soledad",
                autor: "Gabriel García Márquez",
                genero: "Ficción",
                disponibilidad: "No Disponible",
                descripcion: "Una novela multigeneracional que narra la historia de la familia Buendía.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "1984",
                autor: "George Orwell",
                genero: "Ciencia Ficción",
                disponibilidad: "Disponible",
                descripcion: "Una distopía que explora los peligros del totalitarismo.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Orgullo y prejuicio",
                autor: "Jane Austen",
                genero: "Romance",
                disponibilidad: "No Disponible",
                descripcion: "Una novela clásica sobre el amor y las clases sociales en la Inglaterra del siglo XIX.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Harry Potter y la piedra filosofal",
                autor: "J.K. Rowling",
                genero: "Fantasía",
                disponibilidad: "Disponible",
                descripcion: "El inicio de la saga del joven mago Harry Potter.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Los juegos del hambre",
                autor: "Suzanne Collins",
                genero: "Ciencia Ficción",
                disponibilidad: "Disponible",
                descripcion: "Una trilogía distópica sobre una lucha por la supervivencia.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "El código Da Vinci",
                autor: "Dan Brown",
                genero: "Misterio",
                disponibilidad: "No Disponible",
                descripcion: "Un thriller sobre una conspiración religiosa y un misterioso código.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Bajo la misma estrella",
                autor: "John Green",
                genero: "Romance",
                disponibilidad: "Disponible",
                descripcion: "Una emotiva historia de amor entre dos adolescentes con cáncer.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Matar a un ruiseñor",
                autor: "Harper Lee",
                genero: "Ficción Clásica",
                disponibilidad: "Disponible",
                descripcion: "Una novela sobre la injusticia racial en el sur de Estados Unidos.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "El Señor de los Anillos: La Comunidad del Anillo",
                autor: "J.R.R. Tolkien",
                genero: "Fantasía",
                disponibilidad: "No Disponible",
                descripcion: "El inicio de la épica trilogía de El Señor de los Anillos.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Dune",
                autor: "Frank Herbert",
                genero: "Ciencia Ficción",
                disponibilidad: "Disponible",
                descripcion: "Una novela de ciencia ficción épica sobre política, religión y ecología.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Gone Girl",
                autor: "Gillian Flynn",
                genero: "Thriller",
                disponibilidad: "No Disponible",
                descripcion: "Un thriller psicológico sobre un matrimonio que se desmorona y una desaparición.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Los pilares de la Tierra",
                autor: "Ken Follett",
                genero: "Ficción Histórica",
                disponibilidad: "Disponible",
                descripcion: "Una novela histórica sobre la construcción de una catedral en la Inglaterra del siglo XII.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "El alquimista",
                autor: "Paulo Coelho",
                genero: "Filosófica",
                disponibilidad: "No Disponible",
                descripcion: "Una fábula sobre un pastor que sigue su leyenda personal.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Cujo",
                autor: "Stephen King",
                genero: "Terror",
                disponibilidad: "Disponible",
                descripcion: "Una novela de terror sobre un San Bernardo rabioso.",
                imagen: "https://via.placeholder.com/100x150"
            },
            {
                titulo: "Los detectives salvajes",
                autor: "Roberto Bolaño",
                genero: "Literatura",
                disponibilidad: "No Disponible",
                descripcion: "Una novela sobre dos poetas en busca de un poeta desaparecido.",
                imagen: "https://via.placeholder.com/100x150"
            },
        ];

        const listaLibrosElement = document.getElementById("lista-libros");
        const filtroAutoresElement = document.getElementById("filtro-autores");
        const filtroGenerosElement = document.getElementById("filtro-generos");
        const buscarButton = document.getElementById("buscar-button");
        const busquedaInput = document.getElementById("busqueda-input");
        const filtrarButton = document.getElementById("filtrar-button");

        function mostrarLibros(librosAMostrar) {
            listaLibrosElement.innerHTML = "";
            librosAMostrar.forEach(libro => {
                const libroItem = document.createElement("div");
                libroItem.className = "libro-item";

                const libroImagen = document.createElement("img");
                libroImagen.className = "libro-imagen";
                libroImagen.src = libro.imagen;
                libroImagen.alt = `Portada de ${libro.titulo}`;

                const libroInfo = document.createElement("div");
                libroInfo.className = "libro-info";

                const libroTitulo = document.createElement("h3");
                libroTitulo.className = "libro-titulo";
                libroTitulo.textContent = libro.titulo;

                const libroDescripcion = document.createElement("p");
                libroDescripcion.className = "libro-descripcion";
                libroDescripcion.textContent = libro.descripcion;

                const libroEtiquetas = document.createElement("div");
                libroEtiquetas.className = "libro-etiquetas";

                const generoEtiqueta = document.createElement("span");
                generoEtiqueta.className = "libro-etiqueta genero";
                generoEtiqueta.textContent = libro.genero;

                const disponibilidadEtiqueta = document.createElement("span");
                disponibilidadEtiqueta.className = "libro-etiqueta disponibilidad";
                disponibilidadEtiqueta.textContent = libro.disponibilidad;

                libroEtiquetas.appendChild(generoEtiqueta);
                libroEtiquetas.appendChild(disponibilidadEtiqueta);

                libroInfo.appendChild(libroTitulo);
                libroInfo.appendChild(libroDescripcion);
                libroInfo.appendChild(libroEtiquetas);

                libroItem.appendChild(libroImagen);
                libroItem.appendChild(libroInfo);
                listaLibrosElement.appendChild(libroItem);
            });
        }

        function generarFiltros() {
            const autoresSet = new Set();
            const generosSet = new Set();

            libros.forEach(libro => {
                autoresSet.add(libro.autor);
                generosSet.add(libro.genero);
            });

            const autores = Array.from(autoresSet);
            const generos = Array.from(generosSet);

            autores.forEach(autor => {
                const filtroOpcion = document.createElement("div");
                filtroOpcion.className = "filtro-opcion";

                const filtroCheckbox = document.createElement("input");
                filtroCheckbox.type = "checkbox";
                filtroCheckbox.className = "filtro-checkbox";
                filtroCheckbox.value = autor;
                filtroCheckbox.id = `autor-${autor.replace(/\s+/g, '-')}`; // Añade un ID único

                const filtroLabel = document.createElement("label");
                filtroLabel.textContent = autor;
                filtroLabel.className = "filtro-label";
                filtroLabel.htmlFor = `autor-${autor.replace(/\s+/g, '-')}`; // Asocia la etiqueta con el checkbox

                filtroOpcion.appendChild(filtroCheckbox);
                filtroOpcion.appendChild(filtroLabel);
                filtroAutoresElement.appendChild(filtroOpcion);
            });

            generos.forEach(genero => {
                const filtroOpcion = document.createElement("div");
                filtroOpcion.className = "filtro-opcion";

                const filtroCheckbox = document.createElement("input");
                filtroCheckbox.type = "checkbox";
                filtroCheckbox.className = "filtro-checkbox";
                filtroCheckbox.value = genero;
                filtroCheckbox.id = `genero-${genero.replace(/\s+/g, '-')}`; // Añade un ID único

                const filtroLabel = document.createElement("label");
                filtroLabel.textContent = genero;
                filtroLabel.className = "filtro-label";
                filtroLabel.htmlFor = `genero-${genero.replace(/\s+/g, '-')}`; // Asocia la etiqueta con el checkbox

                filtroOpcion.appendChild(filtroCheckbox);
                filtroOpcion.appendChild(filtroLabel);
                filtroGenerosElement.appendChild(filtroOpcion);
            });
        }

        function filtrarLibros() {
            const autoresSeleccionados = Array.from(filtroAutoresElement.querySelectorAll('input:checked'))
                .map(checkbox => checkbox.value);
            const generosSeleccionados = Array.from(filtroGenerosElement.querySelectorAll('input:checked'))
                .map(checkbox => checkbox.value);

            const librosFiltrados = libros.filter(libro => {
                const autorCoincide = autoresSeleccionados.length === 0 || autoresSeleccionados.includes(libro.autor);
                const generoCoincide = generosSeleccionados.length === 0 || generosSeleccionados.includes(libro.genero);
                return autorCoincide && generoCoincide;
            });

            mostrarLibros(librosFiltrados);
        }

        function buscarLibros() {
            const textoBusqueda = busquedaInput.value.toLowerCase();
            const librosFiltrados = libros.filter(libro => {
                return libro.titulo.toLowerCase().includes(textoBusqueda) ||
                    libro.autor.toLowerCase().includes(textoBusqueda) ||
                    libro.genero.toLowerCase().includes(textoBusqueda);
            });
            mostrarLibros(librosFiltrados);
        }

        generarFiltros();
        mostrarLibros(libros);
        buscarButton.addEventListener("click", buscarLibros);
        filtrarButton.addEventListener("click", filtrarLibros);
    </script>

</body>

</html>